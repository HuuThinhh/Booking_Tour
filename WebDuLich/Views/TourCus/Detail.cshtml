@model MyClass.Models.DetailView
@{
    ViewBag.Title = "tourDetail";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var selectedTour = ViewBag.SelectedTour as MyClass.Models.Tour;
    var customer = (MyClass.Models.Customer)System.Web.HttpContext.Current.Session["user"];
}

<div class="container py-lg-5 py-sm-4">
    <h1 class="heading text-capitalize text-center mb-lg-5 mb-4"> Thông tin chi tiết tour </h1>
    @Html.Partial("Message2")
    <div class="contact-grids">
        <div class="row">
            <div class="col-lg-5 contact-left-form">
                <h2>@ViewBag.Name</h2>
                <hr />
                <img src="@Url.Content("~/Public/images/tour_images/"+@ViewBag.Image)" alt="" class="img-fluid" style="width:412px;height:206px" />
                <hr />
                <p><span class="fa fa-tags"></span> <span>Giá người lớn: @string.Format("{0:N0}", @ViewBag.AdultPrice) VNĐ</span></p>
                <hr />
                <p><span class="fa fa-tags"></span> <span>Giá trẻ em: @string.Format("{0:N0}", @ViewBag.ChildPrice) VNĐ</span></p>
                <br />
                <p class="fa fa-exclamation-triangle"> Trẻ em dưới 5 tuổi được miễn phí</p>
                <hr />
                <p>Số lượng còn: @ViewBag.NumberOfParticipants</p>
                <hr />
                <p>Ngày kết thúc: @ViewBag.EndDate.ToString("dd/MM/yyyy")</p>
                <br />
                @if (customer != null)
                {<div class="text-center">
                        <a class="p-2 bg-primary text-light" asp-action="BookingTour" asp-route-id="@selectedTour.Id" href="@Url.Action("BookingTour","TourCus",new {@id=@selectedTour.Id})">Đặt Tour</a>
                    </div>}
                else
                {
                    <div class="text-center">
                        <a class="p-2 bg-primary text-light" href="@Url.Action("Login","Home")">Đăng nhập để đặt tour</a>
                    </div>
                }
                <br />
                <br />
                <hr />
                <br />
                <br />
                <h1 class="text-center">Bình luận</h1>
                <br />
                <div>

                    @foreach (var review in Model.ReviewsDt)
                    {
                        <div>
                            <p class="font-weight-bold"> @review.Customer.LastName @review.Customer.FirstName</p>
                            <p>
                                Số sao: @review.Rating <span class="fa fa-star"></span> - Ngày: @review.ReviewDate.ToString("dd/MM/yyyy")
                            </p>
                            <p>Nội dung: @review.Comment</p>
                            <hr />
                        </div>
                    }
                </div>
                @if (Session["user"] != null)
                {
                    using (Html.BeginForm("Detail", "TourCus", new { id = Model.TourDt.Id }, FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()

                        <div>
                            <br />
                            <h3>Thêm bình luận mới</h3>
                            <div>
                                <span>Số sao: </span>
                                <select name="NewReview.Rating" class="form-control" default-value="5">
                                    <option value="5">5 sao</option>
                                    <option value="4">4 sao</option>
                                    <option value="3">3 sao</option>
                                    <option value="2">2 sao</option>
                                    <option value="1">1 sao</option>
                                </select>
                                @Html.ValidationMessageFor(model => model.NewReview.Rating)
                                <br />
                                <span>Nội dung: </span>
                                @Html.EditorFor(model => model.NewReview.Comment, new { htmlAttributes = new { @class = "form-control", @rows = 4 } })
                                <br />
                                @Html.ValidationMessageFor(model => model.NewReview.Comment, "", new { @class = "text-danger" })
                            </div>

                            <div class="text-center">
                                <br />
                                <input class="p-2 bg-primary text-light" type="submit" value="Gửi bình luận" />
                            </div>
                        </div>
                    }
                }
                else
                {
                    <h5 class="text-danger">Bạn cần đăng nhập để thêm bình luận.</h5>
                }

            </div>
            <div class="col-lg-7 contact-right pl-lg-5 ">
                <p class="mt-3">
                    <h4>Thông tin lịch trình</h4>
                    <hr />
                    @Html.Raw(@ViewBag.Description)
                </p>
            </div>
        </div>
    </div>
</div>
